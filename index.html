<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ù‡Ù†ÙŠØ© | Ù†ÙˆÙ Ø®Ø¨ØªÙŠ</title>

<style>
:root{
  --bg1:#fff3fb;
  --bg2:#f1fff6;
  --bg3:#f3f6ff;

  --card: rgba(255,255,255,.82);
  --border: rgba(17,24,39,.10);
  --text:#111827;
  --muted:#6b7280;

  --shadow: 0 18px 40px rgba(0,0,0,.10);
  --radius: 22px;

  --p1:#ff5ea8;
  --p2:#7c5cff;
  --p3:#22c55e;
  --p4:#06b6d4;
  --p5:#f59e0b;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial;
  color:var(--text);
  background:
    radial-gradient(1200px 700px at 10% 10%, var(--bg1), transparent 60%),
    radial-gradient(1000px 600px at 90% 20%, var(--bg2), transparent 55%),
    radial-gradient(900px 600px at 50% 95%, var(--bg3), transparent 55%);
  min-height:100vh;
  display:flex;
  justify-content:center;
  padding:26px 18px;
}

.wrap{
  width:min(1120px,100%);
  display:flex;
  flex-direction:column;
  gap:18px;
}

/* ===== Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¹Ø§Ù… ===== */
.topHeader{
  text-align:center;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:22px 18px;
}
.topHeader h1{
  margin:0;
  font-size:30px;
  font-weight:1000;
}
.topHeader p{
  margin-top:8px;
  font-size:14px;
  color:rgba(17,24,39,.75);
  line-height:1.8;
  font-weight:700;
}
.topHeader hr{
  border:0;
  border-top:1px solid rgba(17,24,39,.08);
  margin:16px auto 0;
  width:min(680px,92%);
}

/* ===== Ø§Ù„Ø´Ø¨ÙƒØ© ===== */
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:18px;
}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  display:flex;
  flex-direction:column;
  overflow:hidden;
  min-height:520px;
}

/* ===== Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ù‡Ù†ÙŠØ© (ÙŠÙ…ÙŠÙ†) ===== */
.identityWrap{
  padding:18px;
  display:flex;
  flex-direction:column;
  gap:14px;
  height:100%;
}

.identityWrap h2{
  text-align:center;
  font-size:24px;
  font-weight:1000;
  margin:0;
}

.vision{
  background:rgba(255,255,255,.7);
  border:1px solid var(--border);
  border-radius:18px;
  padding:14px;
  font-size:14.5px;
  line-height:2;
  text-align:center;
}

/* ===== Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª 2Ã—2 ===== */
.icons{
  margin-top:auto;
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}

.iconBtn{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:14px;
  border-radius:18px;
  border:1px solid var(--border);
  background:rgba(255,255,255,.9);
  text-decoration:none;
  color:var(--text);
  transition:.15s ease;
  min-height:76px;
}
.iconBtn:hover{ transform: translateY(-2px); }

.iconTxt{ display:flex; flex-direction:column; gap:4px; min-width:0; }
.iconTxt .t{ font-weight:1000; font-size:14px; line-height:1.2; }
.iconTxt .d{ font-size:12px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:230px; }

.iconBubble{
  width:44px;
  height:44px;
  border-radius:16px;
  display:grid;
  place-items:center;
  color:#fff;
  font-size:20px;
}

.g1{background:linear-gradient(135deg,var(--p1),var(--p5))}
.g2{background:linear-gradient(135deg,var(--p2),var(--p1))}
.g3{background:linear-gradient(135deg,var(--p4),#3b82f6)}
.g4{background:linear-gradient(135deg,var(--p3),var(--p4))}

/* ===== Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± (ÙŠØ³Ø§Ø±) ===== */
.mediaWrap{
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:12px;
  height:100%;
}

.stage{
  position:relative;
  flex:1;
  border-radius:18px;
  border:1px solid var(--border);
  background:#fff;
  overflow:hidden;
}

/* âœ… Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± */
.caption{
  position:absolute;
  top:12px;
  right:12px;
  left:12px;
  z-index:6;
  pointer-events:none;
  display:flex;
  justify-content:space-between;
  gap:10px;
}
.capPill{
  max-width:70%;
  background: rgba(255,255,255,.86);
  border:1px solid var(--border);
  padding:8px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:950;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;

  opacity:0;
  transform: translateY(-8px);
  transition: .35s ease;
}
.capPill.show{ opacity:1; transform: translateY(0); }

.counter{
  background: rgba(255,255,255,.86);
  border:1px solid var(--border);
  padding:8px 10px;
  border-radius:999px;
  font-size:12px;
  color:var(--muted);
  white-space:nowrap;
}

.viewer{
  position:absolute;
  inset:0;
  padding:12px;
  display:grid;
  place-items:center;
}

.viewer iframe{
  width:100%;
  height:100%;
  border:0;
  border-radius:14px;
  background:#fff !important;
}

.viewer img,
.viewer video{
  width:100%;
  height:100%;
  object-fit:cover;
  border-radius:14px;
}

.dots{
  display:flex;
  justify-content:center;
  gap:8px;
  flex-wrap:wrap;
}

.dot{
  width:10px;
  height:10px;
  border-radius:50%;
  border:1px solid rgba(0,0,0,.2);
  cursor:pointer;
  background: rgba(255,255,255,.9);
}

.dot.active{
  width:26px;
  border-radius:999px;
  background:linear-gradient(135deg,var(--p1),var(--p2));
}

.controls{
  display:flex;
  gap:10px;
}

.controls button{
  flex:1;
  padding:10px;
  border-radius:999px;
  border:1px solid var(--border);
  background:#fff;
  font-weight:900;
  cursor:pointer;
}

.foot{
  text-align:center;
  font-size:12px;
  color:var(--muted);
  padding:12px;
  border-top:1px solid var(--border);
}

@media(max-width:900px){
  .grid{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="wrap">

<header class="topHeader">
  <h1>Ù†ÙˆÙ Ø®Ø¨ØªÙŠ</h1>
  <p>Ù…Ø¹Ù„Ù…Ø© ÙÙŠØ²ÙŠØ§Ø¡ ÙˆÙ…Ø¨Ø§Ø¯ÙØ±Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ©ØŒ Ø£Ø¤Ù…Ù† Ø¨Ø£Ù† Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¹Ù…ÙŠÙ‚ ÙŠØµÙ†Ø¹ Ø£Ø«Ø±Ù‹Ø§ Ù…Ø³ØªØ¯Ø§Ù…Ù‹Ø§.</p>
  <hr>
</header>

<main class="grid">

  <!-- Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ù‡Ù†ÙŠØ© -->
  <section class="card">
    <div class="identityWrap">
      <h2>Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ù‡Ù†ÙŠØ©</h2>
      <div class="vision">
        ØªØªØ´ÙƒÙ„ Ø±Ø¤ÙŠØªÙŠ Ù…Ù† ÙÙ„Ø³ÙØ© ØªØ±Ø¨ÙˆÙŠØ© ØªÙØ¹Ù„ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„ÙÙ‡Ù… ÙˆØ§Ù„Ù…Ø¹Ù†Ù‰ØŒ ÙˆØªØ¯Ø¹Ù…Ù‡Ø§ Ù…Ù…Ø§Ø±Ø³Ø§Øª ØªØ¯Ø±ÙŠØ³ÙŠØ© ØªÙØ­Ø³Ù† Ø§Ù„ØªØ¹Ù„Ù…
        ÙˆØªÙÙØ¹Ù„ Ø§Ù„Ø­ÙˆØ§Ø± ÙˆØ§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ù†Ø§Ù‚Ø¯ØŒ ÙˆØªØ³ØªØ«Ù…Ø± Ø§Ù„ØªØºØ°ÙŠØ© Ø§Ù„Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªØ¬ÙˆÙŠØ¯ Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª.
      </div>

      <!-- âœ… Ø³ØªÙÙ…Ù„Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ -->
      <div class="icons" id="icons"></div>
    </div>

    <div class="foot">Â© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© â€” Ù†ÙˆÙ Ø®Ø¨ØªÙŠ</div>
  </section>

  <!-- Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± -->
  <section class="card">
    <div class="mediaWrap">
      <div class="stage">

        <!-- âœ… Ø¹Ù†ÙˆØ§Ù† + Ø¹Ø¯Ù‘Ø§Ø¯ -->
        <div class="caption">
          <div class="capPill" id="capText">â€”</div>
          <div class="counter" id="countText">0/0</div>
        </div>

        <div class="viewer" id="viewer"></div>
      </div>

      <div class="dots" id="dots"></div>

      <div class="controls">
        <button id="prevBtn">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
        <button id="toggleBtn">Ø¥ÙŠÙ‚Ø§Ù</button>
        <button id="nextBtn">Ø§Ù„ØªØ§Ù„ÙŠ</button>
      </div>
    </div>

    <div class="foot">Â© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© â€” Ù†ÙˆÙ Ø®Ø¨ØªÙŠ</div>
  </section>

</main>
</div>

<script>
/* âœ… Ø´ÙŠØª Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª (title,url,icon,desc) */
const LINKS_CSV_URL =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vQaN3UjaCfxytCPsU6tVG3q4Doq5MzAga4eN9DNn7CXHO2AgikUq0F3PggFNgMub2C2if6LoRuRDRoD/pub?output=csv";

/* âœ… Ø´ÙŠØª Ø§Ù„ÙˆØ³Ø§Ø¦Ø· (type,url,title) */
const MEDIA_CSV_URL =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vTEHayG4LZPyitS9dWgRweARkU4gWhGc0vxUFjZbOan32ZG6B9zSYpAKd02bE2nkysvXoIC3EH-iN4O/pub?output=csv";

const INTERVAL_MS = 7000;

/* ===== CSV parser ÙŠØ¯Ø¹Ù… Ø§Ù„Ø§Ù‚ØªØ¨Ø§Ø³ ===== */
function splitCSVLine(line){
  const res = [];
  let cur="", inQ=false;
  for(let i=0;i<line.length;i++){
    const ch=line[i];
    if(ch === '"'){
      if(inQ && line[i+1] === '"'){ cur+='"'; i++; }
      else inQ=!inQ;
    } else if(ch === ',' && !inQ){
      res.push(cur); cur="";
    } else cur+=ch;
  }
  res.push(cur);
  return res.map(s=>s.trim());
}
function parseCSV(text){
  const lines = text.trim().split(/\r?\n/).filter(l=>l.trim()!=="");
  if(lines.length < 2) return {header:[], rows:[]};
  const header = splitCSVLine(lines[0]).map(h=>h.toLowerCase());
  const rows = lines.slice(1).map(splitCSVLine);
  return {header, rows};
}
function col(header,name){ return header.indexOf(name.toLowerCase()); }
function esc(s){
  return String(s||"")
    .replaceAll("&","&amp;").replaceAll("<","&lt;")
    .replaceAll(">","&gt;").replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

/* ===== Drive -> preview ===== */
function toDrivePreview(url){
  const m = url.match(/drive\.google\.com\/file\/d\/([^/]+)/i);
  if(!m) return url;
  return `https://drive.google.com/file/d/${m[1]}/preview`;
}

/* ===== Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ===== */
async function loadIcons(){
  const iconsEl = document.getElementById("icons");
  try{
    const r = await fetch(LINKS_CSV_URL, {cache:"no-store"});
    const t = await r.text();
    const {header, rows} = parseCSV(t);

    const tI = col(header,"title");
    const uI = col(header,"url");
    const iI = col(header,"icon");
    const dI = col(header,"desc");

    const items = rows.map(row=>({
      title:(row[tI]||"").trim(),
      url:(row[uI]||"").trim(),
      icon:(row[iI]||"ğŸ”—").trim(),
      desc:(row[dI]||"").trim(),
    })).filter(x=>x.title && x.url).slice(0,4);

    iconsEl.innerHTML = "";
    const bubbles = ["g1","g2","g3","g4"];

    items.forEach((it, idx)=>{
      const a = document.createElement("a");
      a.className = "iconBtn";
      a.href = it.url;
      a.target = "_blank";
      a.rel = "noopener";
      a.innerHTML = `
        <div class="iconTxt">
          <div class="t">${esc(it.title)}</div>
          <div class="d">${esc(it.desc || "")}</div>
        </div>
        <div class="iconBubble ${bubbles[idx%4]}">${esc(it.icon)}</div>
      `;
      iconsEl.appendChild(a);
    });

    if(!items.length){
      iconsEl.innerHTML = `<div style="grid-column:1/-1;color:#6b7280;font-weight:900;text-align:center;">Ø´ÙŠØª Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙØ§Ø±Øº</div>`;
    }

  }catch(e){
    iconsEl.innerHTML = `<div style="grid-column:1/-1;color:#ef4444;font-weight:900;text-align:center;">ØªØ¹Ø°Ø± Ù‚Ø±Ø§Ø¡Ø© Ø´ÙŠØª Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</div>`;
  }
}

/* ===== Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± ===== */
let MEDIA = [];
let i = 0;
let play = true;
let tmr = null;

const v = document.getElementById("viewer");
const d = document.getElementById("dots");
const cap = document.getElementById("capText");
const count = document.getElementById("countText");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");
const toggleBtn = document.getElementById("toggleBtn");

function setCaption(text){
  cap.classList.remove("show");
  cap.textContent = text || "â€”";
  requestAnimationFrame(()=> cap.classList.add("show"));
}

function buildDots(){
  d.innerHTML = "";
  MEDIA.forEach((_,x)=>{
    const dot = document.createElement("div");
    dot.className = "dot";
    dot.onclick = ()=> go(x,true);
    d.appendChild(dot);
  });
}

function go(x, manual=false){
  if(!MEDIA.length) return;
  i = (x + MEDIA.length) % MEDIA.length;

  document.querySelectorAll(".dot").forEach((e,j)=> e.classList.toggle("active", j===i));

  const item = MEDIA[i];
  setCaption(item.title);
  count.textContent = `${i+1}/${MEDIA.length}`;

  // Ø¹Ø±Ø¶
  v.innerHTML = "";
  if(item.type === "image"){
    const img = document.createElement("img");
    img.src = item.url;
    img.alt = item.title || "image";
    // Ù„Ùˆ ÙØ´Ù„: Ø­ÙˆÙ‘Ù„Ù‡ iframe
    img.onerror = () => { v.innerHTML = `<iframe src="${item.url}"></iframe>`; };
    v.appendChild(img);
  } else if(item.type === "video"){
    const vid = document.createElement("video");
    vid.src = item.url;
    vid.autoplay = true;
    vid.muted = true;
    vid.loop = true;
    vid.playsInline = true;
    v.appendChild(vid);
  } else {
    v.innerHTML = `<iframe src="${item.url}"></iframe>`;
  }

  if(manual) restart();
}

function next(manual=false){ go(i+1, manual); }
function prev(manual=false){ go(i-1, manual); }
function toggle(){
  play = !play;
  toggleBtn.textContent = play ? "Ø¥ÙŠÙ‚Ø§Ù" : "ØªØ´ØºÙŠÙ„";
}

function restart(){
  if(tmr) clearInterval(tmr);
  tmr = setInterval(()=>{ if(play) next(false); }, INTERVAL_MS);
}

async function loadMedia(){
  try{
    const r = await fetch(MEDIA_CSV_URL, {cache:"no-store"});
    const t = await r.text();
    const {header, rows} = parseCSV(t);

    const typeI = col(header,"type");
    const urlI  = col(header,"url");
    const titleI= col(header,"title");

    MEDIA = rows.map(row=>{
      let type = (row[typeI] || "iframe").trim().toLowerCase();
      let url  = (row[urlI]  || "").trim();
      const title= (row[titleI]||"").trim();

      // Ø¥Ø°Ø§ Ø¯Ø±Ø§ÙŠÙ: Ø®Ù„ÙŠÙ‡ iframe + preview
      if(/drive\.google\.com\/file\/d\//i.test(url)){
        url = toDrivePreview(url);
        type = "iframe";
      }
      return {type, url, title};
    }).filter(x => x.url);

    buildDots();
    count.textContent = `0/${MEDIA.length || 0}`;

    if(MEDIA.length){
      go(0,false);
      restart();
    } else {
      v.innerHTML = `<div style="color:#6b7280;font-weight:900;text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ³Ø§Ø¦Ø· ÙÙŠ Ø§Ù„Ø´ÙŠØª</div>`;
      setCaption("â€”");
      count.textContent = "0/0";
    }

  }catch(e){
    v.innerHTML = `<div style="color:#ef4444;font-weight:900;text-align:center;">ØªØ¹Ø°Ø± Ù‚Ø±Ø§Ø¡Ø© Ø´ÙŠØª Ø§Ù„ÙˆØ³Ø§Ø¦Ø·</div>`;
    setCaption("ØªØ¹Ø°Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„");
    count.textContent = "0/0";
  }
}

/* Ø£Ø²Ø±Ø§Ø± */
prevBtn.onclick = ()=> prev(true);
nextBtn.onclick = ()=> next(true);
toggleBtn.onclick = ()=> toggle();

/* ØªØ´ØºÙŠÙ„ */
loadIcons();
loadMedia();

/* ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) */
setInterval(loadIcons, 60000);
setInterval(loadMedia, 60000);
</script>
</body>
</html>
